(()=>{var R=n=>new Promise((a,e)=>{let r=new FileReader;r.addEventListener("load",c=>{let o=c?.target?.result;if(!o){e(new TypeError("readImage: No file."));return}a(o)}),r.readAsDataURL(n)}),T=n=>new Promise((a,e)=>{let r=new Image;r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKAQMAAAC3/F3+AAAAA1BMVEUAAACnej3aAAAAAXRSTlPHReaPdQAAAApJREFUCNdjwAsAAB4AAdpxxYoAAAAASUVORK5CYII=",r.addEventListener("load",()=>a(r)),r.addEventListener("error",()=>e(new Error(`Error loading image from URL: '${n}'.`)));try{r.setAttribute("crossOrigin","Anonymous"),r.src=n}catch(c){e(c)}}),x=R;var h={},s=[],w=()=>{s.push([0,0,0,0]),s.push([128,0,0,1]),s.push([0,128,0,2]),s.push([128,128,0,3]),s.push([0,0,128,4]),s.push([128,0,128,5]),s.push([0,128,128,6]),s.push([192,192,192,7]),s.push([128,128,128,8]),s.push([255,0,0,9]),s.push([0,255,0,10]),s.push([255,255,0,11]),s.push([0,0,255,12]),s.push([255,0,255,13]),s.push([0,255,255,14]),s.push([255,255,255,15]),[0,95,135,175,215,255].forEach(n=>{[0,95,135,175,215,255].forEach(a=>{[0,95,135,175,215,255].forEach(e=>{s.push([n,a,e,16+parseInt(""+Math.floor(n/255*5)+Math.floor(a/255*5)+Math.floor(e/255*5),6)])})})}),[8,18,28,38,48,58,68,78,88,98,108,118,128,138,148,158,168,178,188,198,208,218,228,238].forEach(n=>{s.push([n,n,n,232+Math.floor(n/10)])})},W=(n,a)=>[...n].sort((e,r)=>Math.abs(e[0]-a[0])+Math.abs(e[1]-a[1])+Math.abs(e[2]-a[2])-(Math.abs(r[0]-a[0])+Math.abs(r[1]-a[1])+Math.abs(r[2]-a[2]))||e[3]-r[3]).shift()||[0,0,0,0],U=(n,a,e)=>{s.length||w();let r=[n,a,e].toString();return h[r]?h[r]:h[r]=(W(s,[n,a,e])||[])[3]},d=U;var g=document.createElement("canvas"),b=g.getContext("2d"),F=(n,a)=>{let e=n.width,r=n.height;if(e>a.maxWidth){let m=e/a.maxWidth;e=a.maxWidth,r=Math.floor(r/m)}if(r>a.maxHeight){let m=r/a.maxHeight;r=a.maxHeight,e=Math.floor(e/m)}g.width=e,g.height=r,b.drawImage(n,0,0,e,r);let c=b.getImageData(0,0,e,r),o=c.data,u="";for(var t=0,D=o.length,i=0;t<D;)if(a.colours==="true")a.unicode?(o[t]===o[t+e*4]&&o[t+1]===o[t+1+e*4]&&o[t+2]===o[t+2+e*4]?u+="\\e[48;2;"+o[t]+";"+o[t+1]+";"+o[t+2]+"m ":r-i==1?u+="\\e[0m\\e[48;2;"+o[t]+";"+o[t+1]+";"+o[t+2]+"m ":u+="\\e[48;2;"+o[t]+";"+o[t+1]+";"+o[t+2]+"m\\e[38;2;"+o[t+e*4]+";"+o[t+1+e*4]+";"+o[t+2+e*4]+"m\u2584",t+=4,t&&!(t/4%e)&&(u+=`\\e[0m
`,t+=4*e,i+=2)):(u+="\\e[48;2;"+o[t]+";"+o[t+1]+";"+o[t+2]+"m  ",t+=4,i++,t&&!(t/4%e)&&(u+=`\\e[0m
`));else if(a.unicode){let m=d(o[t],o[t+1],o[t+2]),E=d(o[t+e*4],o[t+1+e*4],o[t+2+e*4]);m===E?u+="\\e[48;5;"+m+"m ":r-i==1?u+="\\e[0m\\e[48;5;"+m+"m ":u+="\\e[48;5;"+m+"m\\e[38;5;"+E+"m\u2584",t+=4,t&&!(t/4%e)&&(u+=`\\e[0m
`,t+=4*e,i+=2)}else u+="\\e[48;5;"+d(o[t],o[t+1],o[t+2])+"m  ",t+=4,i++,t&&!(t/4%e)&&(u+=`\\e[0m
`);for(;u.match(/(\\e\[[\d;]+m)([▄ ]+)\1/g);)u=u.replace(/(\\e\[[\d;]+m)([▄ ]+)\1/g,"$1$2");return u},I=F;document.addEventListener("click",n=>{let a=n.target;if(!(a instanceof HTMLElement)||!a.matches("a.copy"))return;n.preventDefault();let e=a.dataset.clipboardTarget??null;if(!e)return;let r=document.querySelector(e);!r||navigator.clipboard.writeText(r.innerText)});var f=document.querySelector(".parser .btn"),p=f.querySelector('input[type="file"]'),L=document.querySelector(".url-container"),l=document.querySelector('input[type="url"]'),A=document.querySelector(".error-container"),M=A.querySelector(".error-content"),y=document.querySelector(".options"),H=Array.from(document.querySelectorAll('input[name="colours"]')),C=document.querySelector('input[name="maxHeight"]'),S=document.querySelector('input[name="maxWidth"]'),q=document.querySelector('input[name="unicode"]'),O=document.querySelector("pre.terminal"),k=document.querySelector("pre.copy-paste code"),v=(n="")=>{if(n===""){A.classList.add("d-none"),M.innerText="";return}A.classList.remove("d-none"),M.innerText=n},P=(n,a=()=>{})=>T(n).then(e=>{let r=I(e,{colours:H.reduce((c,o)=>o.checked?o.value:c,"256"),maxHeight:parseInt(C.value,10),maxWidth:parseInt(S.value,10),unicode:q.checked});O.innerText=r,k.innerText=`printf "${r}";`,v("")}).catch(e=>v(e.message)).finally(()=>a()),B=(n=()=>{})=>{let a=p?.files?.[0],e=l.value;if(a){x(a).then(r=>P(r,n)).catch(r=>v(r.message));return}e&&P(e,n),n()};p.addEventListener("input",()=>{l.value=""});l.addEventListener("input",n=>{if(!l.reportValidity()||l.value===""){n.stopImmediatePropagation();return}p.value=""});[...H,C,S,q,p,l].forEach(n=>n.addEventListener("input",({target:a})=>{requestAnimationFrame(()=>[f,L,y].forEach(e=>e.classList.add("loading"))),B(()=>{[f,L,y].forEach(e=>e.classList.remove("loading")),a===l&&l.focus()})}));})();
//# sourceMappingURL=app.js.map
